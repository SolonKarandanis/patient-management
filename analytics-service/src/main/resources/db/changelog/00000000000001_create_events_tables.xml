<?xml version="1.0" encoding="UTF-8"?>
<databaseChangeLog
        xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-latest.xsd">

    <changeSet id="00000000000001-patient-events" author="solon">
        <comment>Create patient_events table</comment>
        <sql>
            CREATE TABLE IF NOT EXISTS analyticsservice.patient_events (
                id UUID,
                patientId String,
                name String,
                email String,
                event_type String,
                event_timestamp DateTime DEFAULT now()
            ) ENGINE = MergeTree()
            ORDER BY (event_timestamp, id);
        </sql>
    </changeSet>

    <changeSet id="00000000000001-payment-events" author="solon">
        <comment>Create payment_events table</comment>
        <sql>
            CREATE TABLE IF NOT EXISTS analyticsservice.payment_events (
                id UUID,
                patientId String,
                state String,
                amount Float64,
                createdDate DateTime,
                event_timestamp DateTime DEFAULT now()
            ) ENGINE = MergeTree()
            ORDER BY (event_timestamp, id);
        </sql>
    </changeSet>

    <changeSet id="00000000000001-user-events" author="solon">
        <comment>Create user_events table</comment>
        <sql>
            CREATE TABLE IF NOT EXISTS analyticsservice.user_events (
                id UUID,
                userId String,
                username String,
                email String,
                event_type String,
                event_timestamp DateTime DEFAULT now()
            ) ENGINE = MergeTree()
            ORDER BY (event_timestamp, id);
        </sql>
    </changeSet>

    <changeSet id="00000000000001-notification-events" author="solon">
        <comment>Create notification_events table</comment>
        <sql>
            CREATE TABLE IF NOT EXISTS analyticsservice.notification_events (
                id UUID,
                userIds Array(String),
                title String,
                eventType String,
                message String,
                event_timestamp DateTime DEFAULT now()
            ) ENGINE = MergeTree()
            ORDER BY (event_timestamp, id);
        </sql>
    </changeSet>

</databaseChangeLog>